# 当前工作进展 (Progress)

## 2026-02-25
- [x] 初始化项目目录 `nlp_embedding_learning`
- [x] 创建 Manus 风格的规划文件 `task_plan.md`, `findings.md`, `progress.md`
- [x] 制定具体的技术设计方案（语言、框架、手搭架构细节）
- [x] 撰写交互式教学展示界面设计

## 2026-02-25 (当前进展)
- **数据集准备**：生成并确立 `lcqmc_mini.csv` 作为轻量级的开源训练评测数据。
- **环境搭建**：产出 `requirements.txt`。
- **当前进展**：已完全实现核心的基础模型结构与数据加载；已完成交互式的 Streamlit 教学页面；并在 `docs/` 下输出了增量开发文档。
- **阶段完成**：第一阶、第二阶、第三阶构建与第五阶段档产出已全部完成，可进行功能演示。
## 2026-02-25 (增量开发一)
- **目标**：为项目引入 GPU 加速 (MPS/CUDA) 支持，以提升模型的训练和推理速度。
- **当前进展**：已在 `train.py` 训练循环中注入自动检测与 `to(device)` 转移逻辑，同时在 `app.py` 中的 PCA 降维前向传播及单句推理前向传播中增加了 CPU 内存分离回收逻辑（使用 `.cpu().detach()`）。
- **阶段完成**：GPU 支撑适配完毕，运行日志显示已激活 CUDA 加速。

## 2026-02-25 (增量开发二)
- **目标**：实现模型权重的持久化存储（Save Model）。
- **当前进展**：在 `app.py` 中侧边栏添加了“保存模型到本地”的独立交互按钮。点击后会将当前的 `model_weights.pth` 和词表 `tokenizer.pkl` 落盘至新建的 `output/` 文件夹。
## 2026-02-25 (总结与规范制定)
- **目标**：为项目产出 `WORKSPACE_RULES.md` 规范说明书。
- **当前进展**：确立了 KISS 极简开发哲学与 Manus 风格规划机制，收束了文件职责并生成规范性文档。
- **阶段完成**：已产出该说明书，作为本项目后续维护的刚性约束。

## 2026-02-25 (增量开发三)
- **目标**：增加准确率监控指标与全局集相似度分布直方图，可视化模型分辨能力。
- **当前进展**：在 `train.py` 中增加了结合正负阈值的 Acc 计算；在 `app.py` 首页实现了 Loss/Acc 双轨曲线渲染，并在训练完成后使用 `matplotlib.pyplot` 直观地渲染绿色（相似）和红色（不相似）重叠直方分布。
- **阶段完成**：新指标与底层判定能力可视化全部搭建通过。

## 2026-02-26 (增量开发四)
- **目标**：新增 CNN 双塔模型，保留现有 MeanPooling 架构以便对比学习。
- **阶段完成**：CNN 双塔与 MeanPooling 极简双塔共存，前端可视化全部复用。

## 2026-02-26 (增量开发五)
- **目标**：模型架构适配 2w 大数据集；解决 Streamlit 界面卡顿与预测按钮失效问题。
- **当前进展**：
  1. **数据清洗与分词器升级**：在 `data.py` 中增加了滤除 HTML、标点和特殊符号的文本清洗。为 CNN 引入 `jieba` 构建了 `SimpleWordTokenizer` 词级分词器，词表规模扩大至 15773。
  2. **CNN 架构增强**：为了解决 10 轮后 Loss 反弹（过拟合）及余弦距离维度诅咒，为 CNN 增加了 `BatchNorm1d`、`Dropout(0.3)` 以及一个全连接 `Linear` 投影层将卷积拼接特征压缩回 128 维。增强后的 CNN 在 10 轮训练下 Loss 降至 0.3672，反超基线。
  3. **Streamlit 性能攻坚**：解决了 2w 数据集带来的高频 WebSocket 图表推送崩溃问题（增加了每 50 batch 节流刷新）；使用 `@st.cache_resource` 缓存模型加载；使用 `@st.cache_data` 配合 GPU `torch.no_grad()` 批量推理 (`batch_size=256`)，大幅加速全局相似度直方图的渲染，彻底解决了 Tab3 预测按钮遭重计算阻塞导致无法点击的 Bug。
- **阶段完成**：系统成功支撑 2w 规模数据集的训练与全功能高速交互体验。
